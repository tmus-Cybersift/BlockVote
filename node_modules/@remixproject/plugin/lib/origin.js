"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkOrigin = exports.getAllOrigins = exports.getDefaultOrigins = void 0;
const tslib_1 = require("tslib");
/** Fetch the default origins for remix */
function getDefaultOrigins() {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const res = yield fetch('https://raw.githubusercontent.com/ethereum/remix-plugin/master/projects/client/assets/origins.json');
        return res.json();
    });
}
exports.getDefaultOrigins = getDefaultOrigins;
/** Get all the origins */
function getAllOrigins(devMode = {}) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const localhost = devMode.port ? [
            `http://127.0.0.1:${devMode.port}`,
            `http://localhost:${devMode.port}`,
            `https://127.0.0.1:${devMode.port}`,
            `https://localhost:${devMode.port}`,
        ] : [];
        const devOrigins = devMode.origins
            ? (typeof devMode.origins === 'string') ? [devMode.origins] : devMode.origins
            : [];
        const defaultOrigins = yield getDefaultOrigins();
        return [...defaultOrigins, ...localhost, ...devOrigins];
    });
}
exports.getAllOrigins = getAllOrigins;
/**
 * Check if the sender has the right origin
 * @param origin The origin of the incoming message
 * @param devMode Devmode options
 */
function checkOrigin(origin, devMode = {}) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const allOrigins = yield getAllOrigins(devMode);
        return allOrigins.includes(origin);
    });
}
exports.checkOrigin = checkOrigin;
//# sourceMappingURL=origin.js.map